//数据定义
	var menu = '[{"id":1,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u914d\u7f6e\u7ba1\u7406","icon":"<\/i>","remark":"\u914d\u7f6e\u7ba1\u7406","listorder":1,"item2":[{"id":9,"parentid":1,"app":"Admin","model":"index","action":"coninfo","data":null,"urls":"Admin\/index\/coninfo","type":1,"status":1,"name":"\u4e2a\u4eba\u4fe1\u606f","icon":"<\/i>","remark":"\u4e2a\u4eba\u4fe1\u606f","listorder":0,"item3":[]},{"id":10,"parentid":1,"app":"Admin","model":"index","action":"conapp","data":null,"urls":"Admin\/index\/conapp","type":1,"status":1,"name":"\u7f51\u7ad9\u914d\u7f6e","icon":"<\/i>","remark":"\u7f51\u7ad9\u914d\u7f6e","listorder":0,"item3":[]},{"id":11,"parentid":1,"app":"Admin","model":"index","action":"conpage","data":null,"urls":"Admin\/index\/conpage","type":1,"status":1,"name":"\u9875\u9762\u914d\u7f6e","icon":"<\/i>","remark":"\u9875\u9762\u914d\u7f6e","listorder":0,"item3":[]},{"id":12,"parentid":1,"app":"Admin","model":"index","action":"conlang","data":null,"urls":"Admin\/index\/conlang","type":1,"status":1,"name":"\u5e38\u91cf\u914d\u7f6e","icon":"<\/i>","remark":"\u5e38\u91cf\u914d\u7f6e","listorder":0,"item3":[]},{"id":13,"parentid":1,"app":"Admin","model":"index","action":"conother","data":null,"urls":"Admin\/index\/conother","type":1,"status":1,"name":"\u5176\u4ed6\u914d\u7f6e","icon":"<\/i>","remark":"\u5176\u4ed6\u914d\u7f6e","listorder":0,"item3":[]}]},{"id":2,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u680f\u76ee\u7ba1\u7406","icon":"<\/i>","remark":"\u680f\u76ee\u7ba1\u7406","listorder":2,"item2":[{"id":14,"parentid":2,"app":"Admin","model":"menu","action":"nav","data":null,"urls":"Admin\/menu\/nav","type":1,"status":1,"name":"\u524d\u53f0\u680f\u76ee","icon":"<\/i>","remark":"\u524d\u53f0\u680f\u76ee","listorder":0,"item3":[]},{"id":15,"parentid":2,"app":"Admin","model":"menu","action":"menu","data":null,"urls":"Admin\/menu\/menu","type":1,"status":1,"name":"\u540e\u53f0\u680f\u76ee","icon":"<\/i>","remark":"\u540e\u53f0\u680f\u76ee","listorder":0,"item3":[]},{"id":16,"parentid":2,"app":"Admin","model":"Menu","action":"home","data":null,"urls":"Admin\/menu\/home","type":1,"status":1,"name":"\u9996\u9875\u63a7\u5236","icon":"<\/i>","remark":"\u9996\u9875\u63a7\u5236","listorder":0,"item3":[]}]},{"id":3,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u5185\u5bb9\u7ba1\u7406","icon":"<\/i>","remark":"\u5185\u5bb9\u7ba1\u7406","listorder":3,"item2":[{"id":35,"parentid":3,"app":"Admin","model":"book","action":"slider","data":null,"urls":"Admin\/book\/slider","type":1,"status":1,"name":"\u7126\u70b9\u56fe","icon":"<\/i>","remark":"\u7126\u70b9\u56fe","listorder":0,"item3":[]},{"id":36,"parentid":3,"app":"Admin","model":"book","action":"album","data":null,"urls":"Admin\/book\/album","type":0,"status":1,"name":"\u753b\u518c\u7ba1\u7406","icon":"<\/i>","remark":"\u753b\u518c\u7ba1\u7406","listorder":0,"item3":[]},{"id":37,"parentid":3,"app":"Admin","model":"book","action":"news","data":null,"urls":"Admin\/book\/news","type":0,"status":1,"name":"\u516c\u53f8\u65b0\u95fb","icon":"<\/i>","remark":"\u516c\u53f8\u65b0\u95fb","listorder":0,"item3":[]},{"id":38,"parentid":3,"app":"Admin","model":"book","action":"article","data":null,"urls":"Admin\/book\/article","type":1,"status":1,"name":"\u6587\u7ae0\u7ba1\u7406","icon":"<\/i>","remark":"\u6587\u7ae0\u7ba1\u7406","listorder":0,"item3":[]},{"id":39,"parentid":3,"app":"Admin","model":"book","action":"leave","data":null,"urls":"Admin\/book\/leave","type":1,"status":1,"name":"\u7559\u8a00\u7ba1\u7406","icon":"<\/i>","remark":"\u7559\u8a00\u7ba1\u7406","listorder":0,"item3":[]},{"id":40,"parentid":3,"app":"Admin","model":"book","action":"comm","data":null,"urls":"Admin\/book\/comm","type":1,"status":1,"name":"\u8bc4\u8bba\u7ba1\u7406","icon":"<\/i>","remark":"\u8bc4\u8bba\u7ba1\u7406","listorder":0,"item3":[]},{"id":41,"parentid":3,"app":"Admin","model":"book","action":"links","data":null,"urls":"Admin\/book\/links","type":0,"status":1,"name":"\u53cb\u60c5\u94fe\u63a5","icon":"<\/i>","remark":"\u53cb\u60c5\u94fe\u63a5","listorder":0,"item3":[]}]},{"id":4,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u7528\u6237\u7ba1\u7406","icon":"<\/i>","remark":"\u7528\u6237\u7ba1\u7406","listorder":4,"item2":[{"id":17,"parentid":4,"app":"Admin","model":"user","action":"usera","data":null,"urls":"Admin\/user\/usera","type":1,"status":1,"name":"\u7528\u6237\u7ba1\u7406","icon":"<\/i>","remark":"\u7528\u6237\u7ba1\u7406","listorder":0,"item3":[]},{"id":18,"parentid":4,"app":"Admin","model":"user","action":"userb","data":null,"urls":"Admin\/user\/userb","type":1,"status":1,"name":"\u7b2c\u4e09\u65b9\u7528\u6237","icon":"<\/i>","remark":"\u7b2c\u4e09\u65b9\u7528\u6237","listorder":0,"item3":[]},{"id":19,"parentid":4,"app":"Admin","model":"user","action":"admin","data":null,"urls":"Admin\/user\/admin","type":1,"status":1,"name":"\u7ba1\u7406\u5458","icon":"<\/i>","remark":"\u7ba1\u7406\u5458","listorder":0,"item3":[]},{"id":20,"parentid":4,"app":"Admin","model":"user","action":"arole","data":null,"urls":"Admin\/user\/arole","type":1,"status":1,"name":"\u89d2\u8272\u7ba1\u7406","icon":"<\/i>","remark":"\u89d2\u8272\u7ba1\u7406","listorder":0,"item3":[]},{"id":21,"parentid":4,"app":"Admin","model":"user","action":"arule","data":null,"urls":"Admin\/user\/arule","type":1,"status":1,"name":"\u6743\u9650\u7ba1\u7406","icon":"<\/i>","remark":"\u6743\u9650\u7ba1\u7406","listorder":0,"item3":[]}]},{"id":5,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u6570\u636e\u7ba1\u7406","icon":"<\/i>","remark":"\u6570\u636e\u7ba1\u7406","listorder":5,"item2":[{"id":22,"parentid":5,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u6570\u636e\u7ba1\u7406","icon":"<\/i>","remark":"\u6570\u636e\u7ba1\u7406","listorder":0,"item3":[{"id":25,"parentid":22,"app":"Admin","model":"data","action":"datamup","data":null,"urls":"Admin\/data\/datamup","type":1,"status":1,"name":"\u6570\u636e\u4fee\u6539","icon":"<\/i>","remark":"\u6570\u636e\u4fee\u6539","listorder":0},{"id":26,"parentid":22,"app":"Admin","model":"data","action":"datamin","data":null,"urls":"Admin\/data\/datamin","type":1,"status":1,"name":"\u6570\u636e\u5bfc\u5165","icon":"<\/i>","remark":"\u6570\u636e\u5bfc\u5165","listorder":0}]},{"id":23,"parentid":5,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u6570\u636e\u5e93\u7ba1\u7406","icon":"<\/i>","remark":"\u6570\u636e\u5e93\u7ba1\u7406","listorder":0,"item3":[{"id":27,"parentid":23,"app":"Admin","model":"data","action":"databex","data":null,"urls":"Admin\/data\/databex","type":1,"status":1,"name":"\u6570\u636e\u5e93\u5907\u4efd","icon":"<\/i>","remark":"\u6570\u636e\u5e93\u5907\u4efd","listorder":0},{"id":28,"parentid":23,"app":"Admin","model":"data","action":"databim","data":null,"urls":"Admin\/data\/databim","type":1,"status":1,"name":"\u6570\u636e\u5e93\u8fd8\u539f","icon":"<\/i>","remark":"\u6570\u636e\u5e93\u8fd8\u539f","listorder":0}]},{"id":24,"parentid":5,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u6570\u636e\u56de\u6536\u7ad9","icon":"<\/i>","remark":"\u6570\u636e\u56de\u6536\u7ad9","listorder":0,"item3":[{"id":29,"parentid":24,"app":"Admin","model":"data","action":"dataucon","data":null,"urls":"Admin\/data\/dataucon","type":1,"status":1,"name":"\u6587\u7ae0\u56de\u6536\u7ad9","icon":"<\/i>","remark":"\u6587\u7ae0\u56de\u6536\u7ad9","listorder":0},{"id":30,"parentid":24,"app":"Admin","model":"data","action":"datauser","data":null,"urls":"Admin\/data\/datauser","type":1,"status":1,"name":"\u7528\u6237\u56de\u6536\u7ad9","icon":"<\/i>","remark":"\u7528\u6237\u56de\u6536\u7ad9","listorder":0}]}]},{"id":6,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u6587\u4ef6\u7ba1\u7406","icon":"<\/i>","remark":"\u6587\u4ef6\u7ba1\u7406","listorder":6,"item2":[{"id":31,"parentid":6,"app":"Admin","model":"files","action":"filemgb","data":null,"urls":"Admin\/files\/filemgb","type":0,"status":1,"name":"\u6587\u4ef6\u7ba1\u7406","icon":"<\/i>","remark":"\u6587\u4ef6\u7ba1\u7406","listorder":2,"item3":[]},{"id":32,"parentid":6,"app":"Admin","model":"files","action":"filemgr","data":null,"urls":"Admin\/files\/filemgr","type":0,"status":1,"name":"\u6587\u6863\u7ba1\u7406","icon":"<\/i>","remark":"\u6587\u6863\u7ba1\u7406","listorder":3,"item3":[]}]},{"id":7,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":null,"type":1,"status":1,"name":"\u90ae\u4ef6\u7ba1\u7406","icon":"<\/i>","remark":"\u90ae\u4ef6\u7ba1\u7406","listorder":7,"item2":[{"id":33,"parentid":7,"app":"Admin","model":"emails","action":"emailin","data":null,"urls":"Admin\/emails\/emailin","type":0,"status":1,"name":"\u6211\u7684\u90ae\u7bb1","icon":"<\/i>","remark":"\u6211\u7684\u90ae\u7bb1","listorder":2,"item3":[]},{"id":34,"parentid":7,"app":"Admin","model":"emails","action":"emailto","data":null,"urls":"Admin\/emails\/emailto","type":0,"status":1,"name":"\u53d1\u9001\u90ae\u4ef6","icon":"<\/i>","remark":"\u53d1\u9001\u90ae\u4ef6","listorder":3,"item3":[]}]},{"id":8,"parentid":0,"app":null,"model":null,"action":null,"data":null,"urls":"Admin\/index\/index","type":1,"status":1,"name":"\u5176\u4ed6\u7ba1\u7406","icon":"<\/i>","remark":"\u5176\u4ed6\u7ba1\u7406","listorder":8,"item2":[]}]';

	
	

/*页面初始化*/
function pageLoad(pagename,method){
	switch(pagename){
		case "formform":formform();break;
		case "gridgrid":gridgrid();break;
		case "langlang":langlang();break;
		case "c":
		
		break;
		default:console.log('bug');break;
	}
}
//表单脚本
formform(){
	$.getJSON(edwin.ROOT_PATH+"form/form.json",function(data){
		//	formAuto($(".formAuto"),data);
	});
	$(".labelSel").edsel();
	var index = laywait();  setTimeout(function(){layer.close(index)},1000);
	var data = {"txtTel":"18798076684","txtEamil":"104161206@qq.com","txtuser":"dxc5012","txtpassword":"1234568978","txt68":"123456","norinput":"123456","select1":"3","edselreadonly":"6","edSelOne":"6","edSelMuch":"1","mullittle":["3"],"mulMuch":null,"num":"120.00","num2":"100","date":"2017-07-20","time":"2017-07-20 00:00:00","edcheckbox":["2","3"],"radio":"3","musicType":["5","6"],"musicsup":"2","textarea":"123456789","kindeditor":"<span>超级文本框</span>"};
	formLoad($("form[name='gform']"),{"addClass":"edform","data":data});
	
}
$("document").ready(function(){
	//设置值
	$("body").on("click","edSet",function(){
		var data = {"txtTel":"18798076684","txtEamil":"104161206@qq.com","txtuser":"dxc5012","txtpassword":"1234568978","txt68":"123456","norinput":"123456","select1":"3","edselreadonly":"6","edSelOne":"6","edSelMuch":"1","mullittle":["3"],"mulMuch":null,"num":"120.00","num2":"100","date":"2017-07-20","time":"2017-07-20 00:00:00","edcheckbox":["2","3"],"radio":"3","musicType":["5","6"],"musicsup":"2","textarea":"123456789","kindeditor":"<span>超级文本框</span>"};
		var data = formVal($("form[name='gform']"),data); 
		console.log(data);
		
	})
	//获取值
	$(".edGet").click(function(){
		var data = formVal($("form[name='gform']"));
	//	var data = formVal($(".form-input[name='kindeditor']"));
	//	var val  = formVal( $(".form-wrap"),'norinput');
		console.log(data); 
	});
	$(".edSub").click(function(){
		var checkInfo = formCheck($(this).closest("form"),$(this));
		if(checkInfo.isTrue=="N")  return false;
		console.log(checkInfo.data,JSON.stringify(checkInfo.data));
	});
	
	$("#get").click(function(){
		//var val = radioGet($(".linkform"),'radio');
		var val = checkboxGet($(".linkform"),'edcheckbox');
		console.log(val);
	
	});

	$(".dataAdd").click(function(){
		layopen($(this),'LOAD表单添加','<div class="layer-form formAdd"></div>');
		$(".formAdd").load('../public/tool/loadform.html form',function(){
			formLoad( $(".formAdd form") );
		})
	});
	$(".dataEdit").click(function(){
		layopen($(this),'LOAD表单编辑','<div class="layer-form formEdit"></div>');
		$(".formEdit").load('../public/tool/loadform.html form',function(){
			$(".formEdit form").removeAttr("name").find(".formClear").remove(); formLoad( $(".formEdit form") );
		})
	});
	$(".dataDel").click(function(){
		var elm = layopen($(this),'表单添加',$("#dataDel")); 
		elm.find("form").attr("name",'bform').find(".formClear").removeClass('hidden');
	});
	$(".dataDal").click(function(){
		var elm = layopen($(this),'表单编辑',$("#dataDel"));
		elm.find("form").removeClass("edform").removeAttr("name").find(".formClear").addClass('hidden');
	});
	
});
		



//表格脚本
function gridgrid(){
	var gridInfo = gridLoad($("#gridlang"),{}); 
	var gridInfo = gridLoad($("#gridlinks"),{});
}
function ajaxSerData(elm,data){
	layopen(elm,'修改新数据',$("#dataAdd"),'',0,1,'auto');
	$("input[name='lang_name']").val(data.lang_name);
	$("input[name='lang_mark']").val(data.lang_mark);
	$("input[name='lang_data']").val(data.lang_data);
}
$("document").ready(function(){
	$("body").on("click",".grid-data",function(){
		console.log(11);
		//$(this).find("button").click();
	}).on("click",".gridDetBtn",function(){
		var gridform = gridGet($(this).closest(".grid-wrap"),{});
		console.log(gridform);
	});
	
	//添加新数据
	$(".dataAdd").click(function(){
		$(".linkform").attr("name","dataadd").attr("action",dataadd);
		$('.linkform').find("input,select,textarea").val("");
		$(".linkform").find("input[name='links']").val('ed=conlang/da=no/de=no/file=no/base=no/other=no');
		layopen($(this),'添加新数据',$("#dataAdd"),'',0,1,'auto');
		$(".input-group .input-group-addon").dotdotdot({
			callback : function( isTruncated, orgContent ){
				if(isTruncated)$(this).attr('title',orgContent[0]['textContent']);
			},
		});
	});
	$(".dataUp").click(function(){
		laymsg('当前数据库不可提交数据','N')
	});	
	
});	


//国际化脚本
function edSidebar(data,elm){
	$(data).each(function(i,list){
		if(list.submenu){
			var liElm = $('<li>',{"class":"two",html:'<label><i class="fa fa-fw fa-play" aria-hidden="true"></i><a href="javascript:;"><i class="fa fa-fw fa-folder-o" aria-hidden="true"></i>'+list.name+'</a></label>'}).appendTo(elm);
			var ulElm = $('<ul>',{"class":'ul'}).appendTo(liElm);
			edMenu(list.submenu,ulElm);
		}else{
			var liElm = $('<li>',{"class":"one",html:'<label><a href="javascript:;"><i class="fa fa-fw fa-file-o" aria-hidden="true"></i>'+list.name+'</a></label>'}).appendTo(elm);
		}
	});
}
function langDel(){
	var dataInfo = $("#langTable tbody tr.chosen").data(); if(!dataInfo){laymsg('请选择要修改的数据','N');return false;}
	$(edwin.lang).each(function(i,list){
		$.getJSON(edwin.PB_PATH+'lang/'+list+'/lang.json',function(lang){
			var fileAddress = edwin.FILE_PATH+'public/lang/'+list+'/lang.json';
			delete(lang[dataInfo[0]][dataInfo[1]]);
			var json = JSON.stringify(lang);
			setEdmin("file",'json',fileAddress,json);
		});
	});
}
function langList(){
	var langback = $("#langTable").data('lang');
	var keyWord  = $("#langTable").find(".keyword").val();	
	var nowPage  = $("#langTable").find(".edpage").attr("data-nowpage"); 		//当前页
	var pageNum  = ($("#langTable").find(".edpage").attr("data-pageNum"))? $("#langTable").find(".edpage").attr("data-pageNum"):10;
	var temp = [],n=0;
	$.each(langback,function(i,list){
		if(list[2].toString().indexOf(keyWord) > -1 || list[3].toString().indexOf(keyWord) > -1)
		temp[n++]=list;
	});
	$("#langTable .data-tbody").html('');
	$("#langTable .edpage").attr({"data-nums":temp.length,"data-maxpage":Math.ceil(temp.length/pageNum)})
	pageAuto($("#langTable"));
	$.each(temp,function(i,list){
		if(i<(nowPage-1)*pageNum || i>nowPage*pageNum) return true;
		var trElm = $("<tr>",{"class":"data",data:list}).appendTo($("#langTable .data-tbody"));
		var html = '<td class="text-center"><input type="checkbox"></td><td>'+i+'</td><td>'+list[0]+'</td><td>'+list[1]+'</td><td>'+list[2]+'</td>'
		+'<td>'+list[4]+'</td><td>'+list[5]+'</td><td>'+list[6]+'</td>';
		trElm.append(html);
	});
}
function langlang(){
	var langlist = {},langback = [];
	$(edwin.lang).each(function(i,list){
		$.getJSON(edwin.PB_PATH+'lang/'+list+'/lang.json',function(lang){
			langlist[list] = lang;
		});
		$("#langTable thead tr").append('<th class="th'+(i+4)+'"><span>'+list+'</span></th>');
	});
	$.getJSON(edwin.PB_PATH+'lang/zh-CN/lang.json',function(lang){
		var num = 0;
		$.each(lang,function(name,list){
			$.each(list,function(key,val){
				langback[num] = [] ;
				langback[num][0] = name;
				langback[num][1] = key;
				langback[num][2] = name+'-'+key;
				langback[num][3] = val;
				$(edwin.lang).each(function(i,list){
					langback[num][i+4] = langlist[list][name][key];
				});
				num = num +1;
			});
		});
	});
	delete(langlist); $("#langTable").data("lang",langback);
	var gridInfo = gridLoad($(".grid-wrap"),{}); layer.close();
}
$("document").ready(function(){
	$(".langAdd").click(function(){
		var layElm = layopen($(this),'<span lang lang-txt="menu-lang">'+langGet("menu","lang")+'</span>',"1",{area:['500px','420px']});
		layElm.find(".layui-layer-content").load("langHtml.html",function(){
			formLoad(layElm.find("form"));
			$(edwin.lang).each(function(i,list){
				var html = '<div class="block"></div><div class="col-xs-12"><div class="form-wrap">'
				+' <label class="form-label"><div class="eddot lineone">'+list+'</div><i>*</i></label>'
				+'<input class="form-input" type="text" name='+list+' value="" data-reg="isAll">'
				+'</div></div>';
				layElm.find(".form-body").append(html);
			});			
		});
	});
	$(".langEdit").click(function(){
		var dataInfo = $("#langTable tbody tr.chosen").data(); if(!dataInfo){laymsg('请选择要修改的数据','N');return false;}
		var layElm = layopen($(this),'<span lang lang-txt="menu-lang">'+langGet("menu","lang")+'</span>',"1",{area:['500px','420px']});
		layElm.find(".layui-layer-content").load("langHtml.html",function(){
			var dataInfo = $("#langTable tbody tr.chosen").data();
			layElm.find(".form-input").attr("disabled","disabled");
			formLoad(layElm.find("form"));
			$(edwin.lang).each(function(i,list){
				var html = '<div class="block"></div><div class="col-xs-12"><div class="form-wrap">'
				+' <label class="form-label"><div class="eddot lineone">'+list+'</div><i>*</i></label>'
				+'<input class="form-input" type="text" name='+list+' value="" data-reg="isAll">'
				+'</div></div>';
				layElm.find(".form-body").append(html);
			});
			var data = {'langname':dataInfo[0],'langkey':dataInfo[1],'langmark':dataInfo[2],'en':dataInfo[4],'zh-CN':dataInfo[5],'zh-TW':dataInfo[6]};
			formVal(layElm.find("form"),data);
		});
	});
	$("body").on("click",".langEditBtn",function(){
		var checkInfo = formCheck($(this).closest("form"),$(this));
		if(checkInfo.isTrue=="N"){ laymsg(checkInfo.msg,checkInfo.isTrue,{title:langGet('public','regform'),time:1500}); return false;}
		$(edwin.lang).each(function(i,list){
			$.getJSON(edwin.PB_PATH+'lang/'+list+'/lang.json',function(lang){
				var fileAddress = edwin.FILE_PATH+'public/lang/'+list+'/lang.json';
				lang[checkInfo.data.langname][checkInfo.data.langkey] = checkInfo.data[list];
				var json = JSON.stringify(lang);
				setEdmin("file",'json',fileAddress,json);
			});
		});
		layer.close($(this).closest(".layui-layer").attr("data-mark"));
	});
});



